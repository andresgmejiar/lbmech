<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Movement Models • lbmech</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1. Movement Models">
<meta property="og:description" content="lbmech">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lbmech</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/movement.html">1. Movement Models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1. Movement Models</h1>
                        <h4 data-toc-skip class="author">Andrés G. Mejía
Ramón</h4>
            
            <h4 data-toc-skip class="date">2023-05-21</h4>
      
      
      <div class="hidden name"><code>movement.Rmd</code></div>

    </div>

    
    
<p>In this chapter, I introduce the <code>lbmech</code> package for R’s
cost distance tools, originally the core of the <code>lbmech</code>
package’s functionality. I derive cost functions for the movement of an
arbitrary animal from first principles of energetics and mechanical
physics—not from regressed functions of energetic expenditure with
limited applicability across taxa and behavioral modes. This allows us
to ensure that the cost model is generalizable, and allows us to
separate out three independent types of energy expenditure involved in
locomotive transport: (1) kinematic/mechanical work for moving things;
(2) kinematic/mechanical work against gravity for lifting things; and
(3) basal metabolic expenditure required to keep the animal alive. In
the second section. Finally, I provide a brief example of the analytical
framework using GPS, topographic, and ocean current data from the
<em>Illes Balears</em> <span class="citation">(Clementi et al. 2021;
Farr et al. 2007; Lera et al. 2017)</span>.</p>
<div class="section level2">
<h2 id="computational-considerations">1.1 Computational Considerations<a class="anchor" aria-label="anchor" href="#computational-considerations"></a>
</h2>
<p><code>lbmech</code> is a geospatial package originally designed for
least-cost path analysis in <code>R</code> employing differential
surfaces representing the cost to move between any adjacent locations on
the landscape. It contains additional tools to calculate time- and
energy-based costs-of-travel for humans and animals moving across the
landscape, including built-in statistical tools to derive the cost
functions themselves from GPS data. Moreover, the package contains a
number of additional features in development related to estimating
potential energetic net primary productivity on the landscape from
tabulated data; the demographic implications of adaptive processes; and
geostatistical tools to measure inequality. However those functions are
independent of the cost-distance functions of <code>lbmech</code> that
were developed in response to questions arising from the original
purpose and will be discussed in other vignettes.</p>
<p>The general philosophy behind the least-cost aspects of the package
is that energetic and least-cost path analyses should always be simple,
the most time-taking parts should be done at most once, and ideally that
costs should be rooted in empirical reality. In general terms, both the
cost-distance functions of <code>lbmech</code> and the deterministic
functions of the <code>R</code> library <a href="https://agrdatasci.github.io/gdistance/" class="external-link"><code>gdistance</code></a>
<span class="citation">(van Etten 2017)</span> provide similar
capabilities but with notable differences in computation and
ease-of-use. Both employ differential surfaces representing the cost to
move between any adjacent locations on the landscape, and both store
these costs in ways that enumerate the possible transitions. Both then
perform transformations on the cost values before generating a network
graph object and using <a href="https://igraph.org/r/" class="external-link"><code>igraph</code>’s</a> highly-efficient
<code>distances()</code> function <span class="citation">(Csardi and
Nepusz 2006)</span> to perform distance calculations before outputting a
matrix or raster. <a href="https://agrdatasci.github.io/gdistance/" class="external-link"><code>gdistance</code></a>
stores movement costs as their reciprocal ( , i.e. <span class="math inline">\(1/\textrm{resistance}\)</span> in a sparse matrix
representing every possible transition between two cells on a raster.
The use of conductance allows for most cell-to-cell transitions to be
zero, since impossible transitions due to distance have a conductance of
<span class="math inline">\(1/\infty = 0\)</span>. This, in turn, allows
the sparse matrix to be relatively small on the disk or memory given
that zero values are not stored. However, the use of conductance makes
it cumbersome to employ functions where <span class="math inline">\(f(0)
\neq 0\)</span> requiring the use of index masking. This in turn
encounters integer overflow errors with ‘large’ datasets that are
nonetheless of a necessary size for most reasonable purposes. Moreover,
the use of sparse matrices requires that the object be recreated every
time it is modified, greatly limiting I/O speed and severely affecting
complex calculations.</p>
<p><code>lbmech</code> stores data and performs all linear algebra
directly on resistance values using the <a href="https://rdatatable.gitlab.io/data.table/" class="external-link"><code>data.table</code></a>
package <span class="citation">(Dowle et al. 2023)</span>. Not only is
this more intuitive, but it greatly simplifies the syntax necessary for
many types of algebraically simple operations. <code>lbmech</code>
stores each possible movement as its own unique row, with entries for a
<code>from</code> node, a <code>to</code> node, and either the
difference in or raw final and initial values of the raster encountered
during the transition. Nodes are named after the coordinates of the
raster cell to which they correspond, and are stored as character
strings in the form <code>'x,y'</code>. This allows for (1) in-place
modification of objects, greatly increasing processing speed; (2)
bidirectional raster analysis describing accumulated costs to and from a
node, and (3) additive, nonlinear, and multivariate transformations of
large rasters and independent considerations without running into
integer overflow limits. Since <code>lbmech</code> largely functions as
a wrapper for applying <a href="https://rdatatable.gitlab.io/data.table/" class="external-link"><code>data.table</code></a>,
<a href="https://igraph.org/r/" class="external-link"><code>igraph</code></a>, and <a href="https://www.fstpackage.org/" class="external-link"><code>fst</code></a> functions to <a href="https://rspatial.org/" class="external-link"><code>terra</code></a> SpatRaster raster
objects, it’s easy to generate any arbitrary cost function using <a href="https://rdatatable.gitlab.io/data.table/" class="external-link"><code>data.table</code></a>
syntax.</p>
<p>To ensure that the most computationally intensive steps only need to
be performed once for many repeated analyses, <code>lbmech</code> also
modularizes important aspects of the cost-distance workflow such that a
large world of possible movement can be defined with consistent cost
calculations, with the calculations themselves only performed on an
as-needed basis. This allows for otherwise prohibitively-large spatial
regions and fine spatial resolutions to be considered. This is arguably
necessary when land-based transport requires decision-making to be made
at scales on the order of 1-10 m. Files by default are stored in the
temporary directory, however if it’s expected that the particular
procedure will be repeated again after <code>R</code> is reinitialized
it is recommended to designate a consistent workspace directory as
functions are called. This ensures that each file only need be
downloaded once, and each world only needs to be generated . Geographic
projections and transformations are performed with the <a href="https://rspatial.org/" class="external-link"><code>terra</code></a> package <span class="citation">(Hijmans et al. 2023)</span> providing significant
speed upgrades versus <code>raster</code>. Read/write operations are
performed using the <a href="https://rspatial.org/" class="external-link"><code>terra</code></a> and <a href="https://www.fstpackage.org/" class="external-link"><code>fst</code></a> libraries <span class="citation">(Hijmans et al. 2023; Klik 2022)</span>, permitting
fast referential access (and limited partial access) to datasets.
Through this highly-compartmentalized data management scheme,
<code>lbmech</code> can support the use and consistent reprojection of
multiple elevation rasters as a source for a world given a polygon grid
whose objects point to a URL or filepath with that region’s elevation
data set. Additionally, if no elevation data sources are provided,
<code>lbmech</code> will fetch the appropriate SRTM tiles using the <a href="https://github.com/jhollist/elevatr/" class="external-link"><code>elevatr</code></a>
package <span class="citation">(Hollister et al. 2021)</span>.</p>
<p>Finally, to encourage the use of least-cost analysis rooted in
empirical reality, <code>lbmech</code>’s default workflow is geared
towards the study of time- and energy- based considerations when moving
across a landscape as described in the above theory section (although
the use of any cost function is possible as well). The default
<code><a href="../reference/energyCosts.html">energyCosts()</a></code> function used by
<code><a href="../reference/calculateCosts.html">calculateCosts()</a></code> employs a generalized form of Tobler’s
hiking function to estimate maximum preferred walking speed at a given
slope, and one of three biomechanical models for the amount of kinematic
work exerted per unit time or per stride. Unlike similar tools such as
<code>enerscape</code> for <code>R</code> in this regard,
<code>lbmech</code> allows for the estimation of various types of
energetic losses (due to kinematic locomotion, work against gravity,
basal metabolic processes) instead of simply the total energetic or
metabolic expenditure. Moreover, through the <code><a href="../reference/getVelocity.html">getVelocity()</a></code>
function it provides a way of deriving cost functions from GPS data of
human and animal movement. This is significantly easier to collect and
less invasive than the VO<span class="math inline">\(_2\)</span> meters
required for direct estimation of net energetic expenditure. Finally,
<code>lbmech</code> incorporates the <a href="https://CRAN.R-project.org/package=geosphere" class="external-link"><code>geosphere</code></a>
package’s distance functions <span class="citation">(Hijmans et al.
2022)</span> thereby allowing for simple, native geodesic corrections at
all stages of calculation.</p>
</div>
<div class="section level2">
<h2 id="the-energetics-of-locomotion">1.2 The Energetics of Locomotion<a class="anchor" aria-label="anchor" href="#the-energetics-of-locomotion"></a>
</h2>
<p>In order to move across the terrestrial landscape, two principal
types of work must be performed. The first is kinetic work, required to
move an object at a particular speed, <span class="math inline">\(K =
\frac{1}{2}mv^2\)</span> for an arbitrary particle:</p>
<span class="math display">\[\begin{equation}
K = \frac{1}{4} m v^2 \frac{\ell_s}{L}
\end{equation}\]</span>
<p>for human locomotion as derived by <span class="citation">Kuo
(2007)</span>: 654—where <span class="math inline">\(m\)</span> is an
object’s mass, <span class="math inline">\(v\)</span> it’s speed, <span class="math inline">\(\ell_s\)</span> is the average step length and
<span class="math inline">\(L\)</span> the average length of a leg; and
for quadrupeds <span class="math inline">\(K = m(0.685v +
0.072)\)</span> as derived experimentally by <span class="citation">Heglund, Cavagna, and Taylor (1982)</span>. For the
purposes of simplicity, the rest of the derivation will be using the
appropriate parameters for humans but the steps are equivalent for the
derivation of quadrupeds. The second type of work is work against
gravity, required to lift an object a height <span class="math inline">\(h\)</span> (<span class="math inline">\(U =
mgh\)</span>), where <span class="math inline">\(g\)</span> is the
magnitude of the acceleration due to gravity, and <span class="math inline">\(h\)</span> the height an object is raised.
Importantly, this latter form of work cost is incurred only when moving
uphill. Summing the two components results in the total amount of work
performed to move across the landscape:</p>
<span class="math display">\[\begin{equation}
\tag{1}
W = \frac{1}{4} m v^2 \frac{\ell_s}{L} + \begin{cases}
mgh &amp; dz \geq 0\\
0 &amp; dz &lt; 0 \\\end{cases}
\end{equation}\]</span>
<p>To obtain the expected velocity when moving across a landscape of
variable topography, we can employ Tobler’s Hiking function, which
predicts that velocity decreases exponentially as the slope departs from
an `optimum’ slope at which an traveler’s velocity can be maximized:</p>
<span class="math display">\[\begin{equation}
\tag{2}
\frac{d\ell}{dt} = v_{\textrm{max}} e^{-k | \frac{dz}{d\ell} - s |}
\end{equation}\]</span>
<p>where <span class="math inline">\(\ell\)</span> is horizontal
movement, <span class="math inline">\(z\)</span> vertical movement,
<span class="math inline">\(v_{\textrm{max}}\)</span> the maximum
walking speed, <span class="math inline">\(s\)</span> the slope of
maximum speed and <span class="math inline">\(k\)</span> how sensitive
speed variation is to slope. Canonical applications of the Tobler
function for humans employ <span class="math inline">\(v_{\textrm{max}}
= 1.5\)</span> m/s, <span class="math inline">\(k = 3.5\)</span>, and
<span class="math inline">\(s = - 0.05\)</span> = <span class="math inline">\(\tan(-2.83^\circ)\)</span>. However, the
<code><a href="../reference/getVelocity.html">getVelocity()</a></code> function in the <code>lbmech</code> package
allows researchers to obtain the appropriate variables for their subject
species of interest from high-resolution GPS tracking data.</p>
<p>Humans and animals, however, are far from ideal engines. Generally,
for every calorie of work expended humans require five calories of
dietary energy resulting in an efficiency factor of <span class="math inline">\(\varepsilon = 0.2\)</span>. Dividing Eq. 1 by
<span class="math inline">\(\varepsilon\)</span>, and plugging in
Tobler’s Hiking Function (Eq. 2) for <span class="math inline">\(v\)</span> results in the total amount of energy
used by a human to travel between two points on the landscape. This is
our function for kinematic energy expenditure.</p>
<p>People also consume energy just to stay alive as defined by our base
metabolic rate (BMR, represented by <span class="math inline">\(\frac{dH}{dt}\)</span>). Assuming a relatively
constant amount of daily physical activity and by extension a relatively
constant basal metabolic rate, we can model the total amount of energy
used by a human to travel between two points on the landscape and stay
alive, by adding <span class="math inline">\(H\)</span> to our
equation:</p>
<span class="math display">\[\begin{equation}
\tag{3}
E = \frac{1}{4} m v^2 \frac{\ell_s}{L} + \frac{dH}{dt} dt +
\begin{cases}
mgh &amp; dz \geq 0\\
0 &amp; dz &lt; 0 \\\end{cases}
\end{equation}\]</span>
<p>Both of the energetic equations derived above display anisotropic
behavior due to dependence on <span class="math inline">\(\theta =
\arctan \left(\frac{dz}{dx}\right)\)</span>. However, only the potential
energy term is linearly anisotropic whereas the kinetic energy term is
dependent on slope through an exponential term to the second power. As
such, the ArcGIS Distance toolkit is insufficient for true energetic
analyses. This incapacity is largely because it—like other least-cost
tools perform the calculations directly upon the localized value at a
particular cell. Rather, since this is a problem of performing a line
integral over a differential surface, an algorithm that performs its
calculations based on the difference between individual cells is
required.</p>
<p>The figure below plots each of the above cost functions (for time,
kinetic energy, gravitational potential energy, mechanical/kinematic
energy, and net metabolic energy) versus slope, assuming the canonical
parameters for Tobler’s Hiking Function and a human male. <span class="math inline">\(k = 3.5\)</span>, <span class="math inline">\(s =
-0.05\)</span> <span class="math inline">\(m = 68\)</span> kg, <span class="math inline">\(v_\textrm{max} = 1.5\)</span> m/s, <span class="math inline">\(L = 0.75\)</span> m, <span class="math inline">\(\ell_s = 1.6\)</span> m, <span class="math inline">\(g = 9.81\)</span> m/s<span class="math inline">\(^2\)</span>, <span class="math inline">\(\frac{dH}{dt} = 93\)</span> J/s, and <span class="math inline">\(\varepsilon = 0.2\)</span>; (a) Tobler’s Hiking
Function inverted for Pace <span class="math inline">\(t\)</span>; (b)
Kinetic Energy, <span class="math inline">\(K\)</span>; (c) Work against
Gravitational Potential Energy, <span class="math inline">\(U\)</span>;
(e) Kinematic/Mechanical Energy Performed, <span class="math inline">\(W
= K + U\)</span>; (f) Net Metabolic Energy Consumed, <span class="math inline">\(E = \frac{W}{\varepsilon} +
\frac{dH}{dt}t\)</span>.</p>
<p><img src="movement_files/figure-html/costFuns-1.png" width="1056" style="display: block; margin: auto;"></p>
<p>A least-cost path algorithm is going to preferentially select paths
whose segments tend towards the lowest values on these plots. When
minimizing the amount of time (Fig. 1a, and considering the canonical
parameters), slopes closer towards the slope of fastest travel <span class="math inline">\(s = - 0.05\)</span> are preferred, with costs
increasing exponentially as one moves away from that value. When
minimizing the energy of motion (kinetic energy, Fig. 1b), the most
extreme slopes will be preferred since movement is slowest and kinetic
energy is minimized. When minimizing the work performed against
gravitational potential energy (Fig. 1c), any negative slope is equally
preferred, with positive slopes increasing in cost linearly. When
minimizing the kinetic energy, steeper slopes are preferred downhill
mildly over flat-ish slopes, with a notable avoidance of slopes tending
around <span class="math inline">\(s = -0.05\)</span>, with slopes
linearly—but rapidly—increasing in positive slopes. In other words,
downhill movement is primarily kinetic energy-limited, whereas uphill
movement is mainly gravitational potential energy-limited. The situation
is similar for net metabolic energy, but here additional penalties are
incurred for overly-slow routes that be more mechanically efficient but
take long enough that metabolic processes incur costs. Thus, the most
efficient slopes are those that occur at the global minimum at <span class="math inline">\(\frac{dz}{d\ell} = -0.317 =
\arctan(-17.6^\circ)\)</span>.</p>
<p>One final consideration that to date no other least-cost toolkit
rigorously assesses is potential movement on and across water. Movement
considerations across bodies of water are conceptually simpler than
movement across land. The water’s surface can be represented by a
two-dimensional vector field with values at each point representing
water’s surface velocity <span class="math inline">\(\vec{v}_\textrm{water}(x,y)\)</span>, with still
water having a velocity of <span class="math inline">\(\vec{v}_\textrm{water} = 0\)</span>. The velocity
of someone traveling on water then is simply:</p>
<span class="math display">\[\begin{equation}
\tag{4}
\vec{v}(x,y) = \vec{v}_\textrm{water} + \vec{v}_\textrm{travel},
\end{equation}\]</span>
<p>where <span class="math inline">\(\vec{v}_\textrm{travel}(x,y) =
v_\textrm{travel} \hat{\ell}\)</span> is the travel speed of the method
of travel (such as swimming or rowing a boat) over still water, and
<span class="math inline">\(\hat{\ell}\)</span> the intended direction
of travel. If <span class="math inline">\(\vec{v} &lt; 0\)</span>, then
travel in that direction is impossible. For the purposes of simplicity,
we assume that the caloric cost is proportional to <span class="math inline">\(v_\textrm{travel}^2\)</span>.</p>
</div>
<div class="section level2">
<h2 id="estimating-velocity-from-gps-data">1.3 Estimating Velocity from GPS Data<a class="anchor" aria-label="anchor" href="#estimating-velocity-from-gps-data"></a>
</h2>
<p>The GPS dataset consists of 15,296 usable GPX tracks obtained from <a href="https://wikiloc.com" class="external-link uri">https://wikiloc.com</a>, and was
first described by <span class="citation">Lera et al. (2017)</span> who
used it to identify seasonal variability in hiking trail activity and
network organization. Given a directory with <code>.gpx</code> files,
the tracks can be imported as a data.table using
<code><a href="../reference/importGPX.html">lbmech::importGPX()</a></code>:</p>
<p>Since GPS tracks can be sampled at a per-length rate smaller than the
size of even the smallest raster pixels we might employ, GPS tracks are
downsampled to a comparable rate—about a pixel length per GPS sample.
For an expected pixel size of 50 m and an approximate maximum speed of
1.5 m/s, <code>t_step = 50/1.5</code>. We can use the
<code><a href="../reference/downsampleXYZ.html">lbmech::downsampleXYZ()</a></code> function for this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/downsampleXYZ.html">downsampleXYZ</a></span><span class="op">(</span><span class="va">gpx</span>, t_step <span class="op">=</span> <span class="fl">50</span><span class="op">/</span><span class="fl">1.5</span>,</span>
<span>                     t <span class="op">=</span> <span class="st">'t'</span>, x <span class="op">=</span> <span class="st">'long'</span>, y <span class="op">=</span> <span class="st">'lat'</span>, z <span class="op">=</span> <span class="st">'z'</span>, </span>
<span>                     ID <span class="op">=</span> <span class="st">'TrackID'</span><span class="op">)</span></span></code></pre></div>
<p>The xyz data is then passed to <code><a href="../reference/getVelocity.html">lbmech::getVelocity()</a></code>,
which for each sequence of GPS points (1) calculates the changes in
elevation <span class="math inline">\(\frac{dz}{d\ell}\)</span> and
planimetric speed <span class="math inline">\(\frac{d\ell}{dt}\)</span>,
and (2) performs a nonlinear quantile regression to get a function of
the form Tobler, which returns a list with the nonlinear model, the
model parameters, and the transformed data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">velocity_gps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getVelocity.html">getVelocity</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gpx</span><span class="op">[</span><span class="va">y</span> <span class="op">&lt;</span> <span class="fl">90</span><span class="op">]</span>, <span class="co"># Filter for y</span></span>
<span>                            degs <span class="op">=</span> <span class="cn">TRUE</span>,        <span class="co"># Lat/Long; geodesic correction</span></span>
<span>                            tau_vmax <span class="op">=</span> <span class="fl">0.95</span>,    <span class="co"># Quantile for v_max</span></span>
<span>                            tau_nlrq <span class="op">=</span> <span class="fl">0.50</span>,    <span class="co"># Quantile for nlrq</span></span>
<span>                            v_lim <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>          <span class="co"># Filter for dl/dt</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">velocity_gps</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">velocity_gps</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; Nonlinear quantile regression</span></span>
<span><span class="co">#&gt;    model:  dl_dt ~ v_max * exp(-k * abs(dz_dl - s)) </span></span>
<span><span class="co">#&gt;     data:  [ data (dl_dt &lt;= v_lim) &amp; (dl_dt &gt; v_min) &amp; abs(dz_dl) &lt;= slope_lim </span></span>
<span><span class="co">#&gt;      tau:  0.5 </span></span>
<span><span class="co">#&gt; deviance:  1458241 </span></span>
<span><span class="co">#&gt;       k       s </span></span>
<span><span class="co">#&gt;  5.5890 -0.0392 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vmax</span></span>
<span><span class="co">#&gt; [1] 1.61</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $s</span></span>
<span><span class="co">#&gt; [1] -0.0392</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $k</span></span>
<span><span class="co">#&gt; [1] 5.59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tau_vmax</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tau_nlrq</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span></code></pre></div>
<p>Finally, the <code><a href="../reference/plotVelocity.html">lbmech::plotVelocity()</a></code> function can be used
to plot the log-transformed probability of a given speed at a given
slope versus the regressed function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotVelocity.html">plotVelocity</a></span><span class="op">(</span><span class="va">velocity_gps</span><span class="op">)</span></span></code></pre></div>
<p><img src="movement_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="energetic-cost-distance-analysis">1.4 Energetic Cost-Distance Analysis<a class="anchor" aria-label="anchor" href="#energetic-cost-distance-analysis"></a>
</h2>
<p>Given the large amounts of data downloaded, processed, and re-used at
different parts of the workflow, it is highly recommended to define a
consistent directory for the workflow particularly during model-building
stages.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a working directory</span></span>
<span><span class="va">rd</span> <span class="op">&lt;-</span> <span class="st">"Baleares"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><code>lbmech</code> can automatically download terrain data, but we
also want to consider ocean movement. Here, we’ll import the
Mediterranean Sea Physics Analysis and Forecast (CMEMS MED-Currents,
EAS6 system) <span class="citation">(Clementi et al. 2021)</span> for
ocean currents around two of the principal Balearic Islands—Mallorca and
Menorca—on 13 June 2022 and define our region of maximum movement (our
‘world’) around that raster’s extent. Note that the user needs to
provide their own username and password:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># MOTU Command to download Barealic Island ocean velocity</span></span>
<span><span class="co"># Note that you have to provide your own username and password</span></span>
<span><span class="va">command</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'python -m motuclient --motu https://nrt.cmems-du.eu/motu-web/Motu --service-id MEDSEA_ANALYSISFORECAST_PHY_006_013-TDS --product-id cmems_mod_med_phy-cur_anfc_4.2km_P1D-m --longitude-min 1.8343864083631984 --longitude-max 4.736546729949184 --latitude-min 38.85730429069023 --latitude-max 40.484272955821766 --date-min "2022-06-13 00:00:00" --date-max "2022-06-14 00:00:00" --depth-min 1.0182366371154785 --depth-max 1.0182366371154785 --variable uo --variable vo --out-dir '</span>, <span class="va">rd</span> ,<span class="st">' --out-name Ocean_Currents.nc --user #YOUR#USERNAME#HERE# --pwd #YOUR#PASSWORD#HERE#&gt;'</span><span class="op">)</span></span>
<span> </span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="va">command</span>, intern <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span> </span>
<span><span class="co"># Import an ocean water surface velocity dataset</span></span>
<span><span class="va">currents</span> <span class="op">&lt;-</span> <span class="fu">project</span><span class="op">(</span><span class="fu">rast</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">rd</span>,<span class="st">"/Ocean_Currents.nc"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="va">proj</span><span class="op">)</span></span>
<span></span>
<span> </span>
<span><span class="co"># Projection will be UTM 31N WGS1984</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="st">"EPSG:32631"</span></span>
<span> </span>
<span><span class="co"># Define region of maximum possible movement</span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu">as.polygons</span><span class="op">(</span><span class="fu">ext</span><span class="op">(</span><span class="va">currents</span><span class="op">)</span>,<span class="va">proj</span><span class="op">)</span></span>
<span> </span></code></pre></div>
<pre><code><span><span class="co">#&gt; Reading layer `Baleares_Region' from data source </span></span>
<span><span class="co">#&gt;   `D:\lbmech\Altar\Vignettes\outputs\Baleares_Region.kml' using driver `KML'</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XYZ</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -10.8 ymin: 34.9 xmax: 18 ymax: 44.2</span></span>
<span><span class="co">#&gt; z_range:       zmin: -4880 zmax: 345</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span></code></pre>
<p><img src="movement_files/figure-html/unnamed-chunk-8-1.png" width="2666.66666666667" style="display: block; margin: auto;"></p>
<p>As with any raster operation, a consistent projection and grid needs
to be defined to snap/fix all sources. However, unlike most raster
packages <code>lbmech</code> does not require foreknowledge of the
spatial extents; only the resolution and offsets. A raster can be
provided, or one can be made with the <code><a href="../reference/fix_z.html">lbmech::fix_z()</a></code>
function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the raster properties</span></span>
<span><span class="va">z_fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fix_z.html">fix_z</a></span><span class="op">(</span>proj <span class="op">=</span> <span class="va">proj</span>, </span>
<span>               res <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Although a ‘world’ can be defined directly based on a digital
elevation model, generally it is easier to define a polygon coincident
with the coverage of a digital elevation model and an attribute pointing
to a URL/filepath with the source. The <code><a href="../reference/makeGrid.html">lbmech::makeGrid()</a></code>
can make such a polygon for a raster or filepath input, while using a
polygon will induce future functions to download SRTM data as-needed.
Similar polygons are frequently distributed by state GIS agencies
(e.g. <a href="https://www.pasda.psu.edu/download/pamap/" class="external-link">Pennsylvania</a>; <a href="https://www.mass.gov/info-details/massgis-data-lidar-terrain-data-index" class="external-link">Massachusetts</a>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a grid</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrid.html">makeGrid</a></span><span class="op">(</span>dem <span class="op">=</span> <span class="va">region</span>,     <span class="co"># Input; here polygon for SRTM</span></span>
<span>                 nx <span class="op">=</span> <span class="fl">15</span>, ny <span class="op">=</span> <span class="fl">15</span>, <span class="co"># Cols/Rows to divide the polygon</span></span>
<span>                 sources <span class="op">=</span> <span class="cn">TRUE</span>,   <span class="co"># Just crop/divide, or point to source?</span></span>
<span>                 zoom <span class="op">=</span> <span class="fl">11</span>,        <span class="co"># Zoom level for SRTM data </span></span>
<span>                 overlap <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>   <span class="co"># Fraction overlap between adjacent tiles</span></span></code></pre></div>
<p>A ‘world’ is formally defined as a directory containing all possible
constraints on movement, fixed to a particular spatial projection. Given
the very large areas and relatively-small spatial resolutions often
employed, the data can rapidly become too large to compute all at once
in the memory. the <code><a href="../reference/defineWorld.html">defineWorld()</a></code> function divides the
potential world of movement into individual, slightly-overlapping
‘sectors’ that are calculated and read-in only as needed. It itself
generally is not used to perform calculations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define world of motion within a workspace</span></span>
<span><span class="fu"><a href="../reference/defineWorld.html">defineWorld</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">grid</span>,            <span class="co"># Elevation source, like makeGrid() output</span></span>
<span>            grid <span class="op">=</span> <span class="va">grid</span>,              <span class="co"># How to divide up the world</span></span>
<span>            directions <span class="op">=</span> <span class="fl">8</span>,           <span class="co"># How adjacency between cells are defined </span></span>
<span>            neighbor_distance <span class="op">=</span> <span class="fl">10</span>,   <span class="co"># Overlap between tiles in addition to ^</span></span>
<span>            cut_slope <span class="op">=</span> <span class="fl">0.5</span>,          <span class="co"># Maximum traversible slope</span></span>
<span>            water <span class="op">=</span> <span class="va">currents</span>,         <span class="co"># Water velocity source</span></span>
<span>            priority <span class="op">=</span> <span class="st">'land'</span>,        <span class="co"># If data for land or water, who wins</span></span>
<span>            z_min <span class="op">=</span> <span class="fl">0</span>,                <span class="co"># Minimum elevation, below NA in land</span></span>
<span>            z_fix <span class="op">=</span> <span class="va">z_fix</span>,            <span class="co"># Grid with defined projection, resolution</span></span>
<span>            dist <span class="op">=</span> <span class="st">'karney'</span>,          <span class="co"># Geodesic correction method</span></span>
<span>            dir <span class="op">=</span> <span class="va">rd</span>,                 <span class="co"># Working directory</span></span>
<span>            overwrite<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Once a world has been defined, a cost function can be applied using
the <code>lgmech::calculateCosts()</code> function. The
<code><a href="../reference/energyCosts.html">lbmech::energyCosts()</a></code> function is provided to perform
least-time, least-work, and least-energy analyses as in the above
sections of this manuscript. As with <code><a href="../reference/defineWorld.html">lbmech::defineWorld()</a></code>,
it itself is not generally used to perform calculations—just to define
the values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculateCosts.html">calculateCosts</a></span><span class="op">(</span>costFUN <span class="op">=</span> <span class="va">energyCosts</span>,  </span>
<span>               dir <span class="op">=</span> <span class="va">rd</span>,                    <span class="co"># Working directory with world</span></span>
<span>               method <span class="op">=</span> <span class="st">"kuo"</span>,              <span class="co"># Method to calculate work</span></span>
<span>               water <span class="op">=</span> <span class="cn">TRUE</span>,                <span class="co"># Consider water, or only land?</span></span>
<span>               v_max <span class="op">=</span> <span class="va">velocity_gps</span><span class="op">$</span><span class="va">vmax</span>,   <span class="co"># Max walking speed (m/s)</span></span>
<span>               k <span class="op">=</span> <span class="va">velocity_gps</span><span class="op">$</span><span class="va">k</span>,          <span class="co"># Slope sensitivity (dimensionless)</span></span>
<span>               s <span class="op">=</span> <span class="va">velocity_gps</span><span class="op">$</span><span class="va">s</span>,          <span class="co"># Slope of fastest motion (dimlss.)</span></span>
<span>               row_speed <span class="op">=</span> <span class="fl">1.8</span>,             <span class="co"># Speed over water (m/s)</span></span>
<span>               row_work <span class="op">=</span> <span class="fl">581</span>,              <span class="co"># work over water (J/s)</span></span>
<span>               m <span class="op">=</span> <span class="fl">68</span>,                      <span class="co"># Mass (kg)</span></span>
<span>               BMR <span class="op">=</span> <span class="fl">72</span>,                    <span class="co"># Basal metabolic rate (J/s)</span></span>
<span>               l_s <span class="op">=</span> <span class="fl">1.8</span>,                   <span class="co"># Stride length (m)</span></span>
<span>               L <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>                     <span class="co"># Leg length</span></span></code></pre></div>
<p>For a given (set of) cost function(s) and origin(s)/destination(s),
<code><a href="../reference/getCosts.html">getCosts()</a></code> will identify the needed sectors, make sure the
data has been downloaded (and do so if not), perform the calculations,
and save the cell-wise transition cost tables to the working directory.
That way, if they are needed for another calculation in the future they
won’t need to be fetched and prepossessed again.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import locations on Mallorca, Menorca, and Cabrera</span></span>
<span><span class="va">pobles</span> <span class="op">&lt;-</span> <span class="fu">vect</span><span class="op">(</span><span class="st">"localitats.shp"</span><span class="op">)</span></span>
<span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">as.polygons</span><span class="op">(</span><span class="fu">ext</span><span class="op">(</span><span class="fu">buffer</span><span class="op">(</span><span class="va">pobles</span>, <span class="fl">10000</span><span class="op">)</span><span class="op">)</span>,crs <span class="op">=</span> <span class="fu">crs</span><span class="op">(</span><span class="va">proj</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">costs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCosts.html">getCosts</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">reg</span>,              <span class="co"># Area of maximum movement</span></span>
<span>                  from <span class="op">=</span> <span class="va">pobles</span>,             <span class="co"># Origins</span></span>
<span>                  to <span class="op">=</span> <span class="cn">NULL</span>,                 <span class="co"># Destinations </span></span>
<span>                  costname <span class="op">=</span> <span class="st">'energyCosts'</span>,  <span class="co"># Name of costFUN above</span></span>
<span>                  id <span class="op">=</span> <span class="st">'Location'</span>,           <span class="co"># Column with origin names</span></span>
<span>                  dir <span class="op">=</span> <span class="va">rd</span>,                  <span class="co"># Directory with world</span></span>
<span>                  destination <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span>       <span class="co"># Distance to all points in region</span></span></code></pre></div>
<p>Likewise, least-cost paths can be computed given a set of nodes:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find all least-cost paths between Palma de Mallorca and Ma??</span></span>
<span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPaths.html">getPaths</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">reg</span>,</span>
<span>                  nodes <span class="op">=</span> <span class="va">pobles</span>,</span>
<span>                  costname <span class="op">=</span> <span class="st">'energyCosts'</span>,</span>
<span>                  order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Palma de Mallorca"</span>,<span class="st">"Ma??"</span><span class="op">)</span>,</span>
<span>                  id <span class="op">=</span> <span class="st">'Location'</span>,</span>
<span>                  dir <span class="op">=</span> <span class="va">rd</span><span class="op">)</span></span></code></pre></div>
<p><img src="movement_files/figure-html/unnamed-chunk-16-1.png" width="816" style="display: block; margin: auto;"></p>
<p>Corridors describe the minimum cost required to take a detour to a
given location on a path between two or more given points relative to
the least cost path between those points. These can be calculated from
the output cost rasters using the <code><a href="../reference/makeCorridor.html">lbmech::makeCorridor()</a></code>
function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeCorridor.html">makeCorridor</a></span><span class="op">(</span>rasters <span class="op">=</span> <span class="va">costs</span>, </span>
<span>                     order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Castell de Cabrera"</span>,<span class="st">"Sa Calobra"</span>,<span class="st">"Ma??"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Clementi2021" class="csl-entry">
Clementi, E., Ali Aydogdu, A. C. Goglio, Jenny Pistoia, Romain Escudier,
Massimiliano Drudi, Alessandro Grandi, et al. 2021. <span>“Mediterranean
<span>Sea Physics Analysis</span> and <span>Forecast</span> (<span>CMEMS
MED-Currents</span>, <span>EAS6</span> System).”</span> <span>Copernicus
Marine Service</span>. <a href="https://doi.org/10.25423/CMCC/MEDSEA_ANALYSISFORECAST_PHY_006_013_EAS7" class="external-link">https://doi.org/10.25423/CMCC/MEDSEA_ANALYSISFORECAST_PHY_006_013_EAS7</a>.
</div>
<div id="ref-Csardi2006" class="csl-entry">
Csardi, Gabor, and Tamas Nepusz. 2006. <span>“The Igraph <span>Software
Package</span> for <span>Complex Network Research</span>.”</span>
<em>InterJournal</em> Complex Systems: 1695. <a href="https://igraph.org" class="external-link">https://igraph.org</a>.
</div>
<div id="ref-Dowle2023" class="csl-entry">
Dowle, Matt, Arun Srinivasan, Michael Chirico, Pasha Stetsenko, Tom
Short, Steve Lianoglou, Eduard Antonyan, et al. 2023. <em>Data.table:
<span>Extension</span> of ’Data.frame’</em> (version 1.14.8). <a href="https://cran.r-project.org/web/packages/data.table/index.html" class="external-link">https://cran.r-project.org/web/packages/data.table/index.html</a>.
</div>
<div id="ref-vanEtten2017" class="csl-entry">
Etten, Jacob van. 2017. <span>“<em>R</em> <span>Package</span>
<strong>Gdistance</strong> : <span>Distances</span> and
<span>Routes</span> on <span>Geographical Grids</span>.”</span>
<em>Journal of Statistical Software</em> 76 (13). <a href="https://doi.org/10.18637/jss.v076.i13" class="external-link">https://doi.org/10.18637/jss.v076.i13</a>.
</div>
<div id="ref-Farr2007" class="csl-entry">
Farr, Tom G., Paul A. Rosen, Edward Caro, Robert Crippen, Riley Duren,
Scott Hensley, Michael Kobrick, et al. 2007. <span>“The <span>Shuttle
Radar Topography Mission</span>.”</span> <em>Reviews of Geophysics</em>
45 (2). <a href="https://doi.org/10.1029/2005RG000183" class="external-link">https://doi.org/10.1029/2005RG000183</a>.
</div>
<div id="ref-Heglund1982" class="csl-entry">
Heglund, N. C., G. A. Cavagna, and C. R. Taylor. 1982. <span>“Energetics
and Mechanics of Terrestrial Locomotion. <span>III</span>.
<span>Energy</span> Changes of the Centre of Mass as a Function of Speed
and Body Size in Birds and Mammals.”</span> <em>Journal of Experimental
Biology</em> 97 (1): 41–56. <a href="https://doi.org/10.1242/jeb.97.1.41" class="external-link">https://doi.org/10.1242/jeb.97.1.41</a>.
</div>
<div id="ref-Hijmans2023" class="csl-entry">
Hijmans, Robert J., Roger Bivand, Edzer Pebesma, and Michael D. Sumner.
2023. <em>Terra: <span>Spatial Data Analysis</span></em> (version
1.7-29). <a href="https://cran.r-project.org/web/packages/terra/index.html" class="external-link">https://cran.r-project.org/web/packages/terra/index.html</a>.
</div>
<div id="ref-Hijmans2022" class="csl-entry">
Hijmans, Robert J., Charles Karney (GeographicLib), Ed Williams, and
Chris Vennes. 2022. <em>Geosphere: <span>Spherical
Trigonometry</span></em> (version 1.5-18). <a href="https://cran.r-project.org/web/packages/geosphere/index.html" class="external-link">https://cran.r-project.org/web/packages/geosphere/index.html</a>.
</div>
<div id="ref-Hollister2021" class="csl-entry">
Hollister, Jeffrey, Tarak Shah, Alec L. Robitaille, Marcus W. Beck, and
Mike Johnson. 2021. <em>Elevatr: <span>Access</span> Elevation Data from
Various <span>APIs</span></em>. Manual. <a href="https://doi.org/10.5281/zenodo.5809645" class="external-link">https://doi.org/10.5281/zenodo.5809645</a>.
</div>
<div id="ref-Klik2022" class="csl-entry">
Klik, Mark. 2022. <em>Fst: <span>Lightning Fast Serialization</span> of
<span>Data Frames</span></em> (version 0.9.8). <a href="https://cran.r-project.org/web/packages/fst/index.html" class="external-link">https://cran.r-project.org/web/packages/fst/index.html</a>.
</div>
<div id="ref-Kuo2007" class="csl-entry">
Kuo, Arthur D. 2007. <span>“The Six Determinants of Gait and the
Inverted Pendulum Analogy: <span>A</span> Dynamic Walking
Perspective.”</span> <em>Human Movement Science</em> 26 (4): 617–56. <a href="https://doi.org/10.1016/j.humov.2007.04.003" class="external-link">https://doi.org/10.1016/j.humov.2007.04.003</a>.
</div>
<div id="ref-Lera2017" class="csl-entry">
Lera, Isaac, Toni Pérez, Carlos Guerrero, Víctor M. Eguíluz, and Carlos
Juiz. 2017. <span>“Analysing Human Mobility Patterns of Hiking
Activities Through Complex Network Theory.”</span> <em>PLOS ONE</em> 12
(5): e0177712. <a href="https://doi.org/10.1371/journal.pone.0177712" class="external-link">https://doi.org/10.1371/journal.pone.0177712</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andres G. Mejia Ramon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
